
CREATE TABLE CDW_SAPP_D_CUSTOMER (
    FIRST_NAME VARCHAR(40),
    MIDDLE_NAME VARCHAR(40),
    LAST_NAME VARCHAR(40),
    SSN VARCHAR(9) PRIMARY KEY,
    APT_NO VARCHAR(7),
    STREET_NAME VARCHAR(30),
    CUST_CITY VARCHAR(30),
    CUST_STATE VARCHAR(30),
    CUST_COUNTRY VARCHAR(30),
    CUST_ZIP VARCHAR(7),
    CUST_PHONE VARCHAR(10),
    CUST_EMAIL VARCHAR(40)
);


CREATE TABLE CDW_SAPP_D_VENDOR (
    VENDOR_NAME VARCHAR(40),
    Vendor_SSN VARCHAR(9) PRIMARY KEY,
    Vendor_STREET_NAME VARCHAR(40),
    Vendor_CITY VARCHAR(20),
    Vendor_STATE VARCHAR(20),
    Vendor_Country VARCHAR(20),
    Vendor_zip VARCHAR(7),
    Vendor_email VARCHAR(30),
    Vendor_phone VARCHAR(10)
);


CREATE TABLE CDW_SAPP_D_GEOGRAPHY (
    Geography_Id VARCHAR(10) PRIMARY KEY,
    Geography_name VARCHAR(40)
);


CREATE TABLE CDW_SAPP_D_PART (
    PART_Id VARCHAR(10) PRIMARY KEY,
    PART_name VARCHAR(40),
    No_of_part INT,
    Price DECIMAL(10, 2)
);


CREATE TABLE CDW_SAPP_D_VENDOR_PARTS (
    Vendor_Ssn VARCHAR(9),
    PART_Id VARCHAR(10),
    PRIMARY KEY (Vendor_Ssn, PART_Id),
    FOREIGN KEY (Vendor_Ssn) REFERENCES CDW_SAPP_D_VENDOR(Vendor_SSN),
    FOREIGN KEY (PART_Id) REFERENCES CDW_SAPP_D_PART(PART_Id)
);


CREATE TABLE CDW_SAPP_F_PART_SALES_FACT (
    Cust_ssn VARCHAR(9),
    Vendor_ssn VARCHAR(9),
    Geography_id VARCHAR(10),
    Part_id VARCHAR(10),
    PRIMARY KEY (Cust_ssn, Vendor_ssn, Geography_id, Part_id),
    FOREIGN KEY (Cust_ssn) REFERENCES CDW_SAPP_D_CUSTOMER(SSN),
    FOREIGN KEY (Vendor_ssn) REFERENCES CDW_SAPP_D_VENDOR(Vendor_SSN),
    FOREIGN KEY (Geography_id) REFERENCES CDW_SAPP_D_GEOGRAPHY(Geography_Id),
    FOREIGN KEY (Part_id) REFERENCES CDW_SAPP_D_PART(PART_Id)
);
